<ion-header>
  <ion-toolbar>
    <ion-title>Recordatorios</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">

  <!-- Lista de recordatorios existentes -->
  <div *ngIf="recordatorios.length > 0; else sinRecordatorios">
    <div *ngFor="let r of recordatorios" class="rec-item">
      <h3>{{ r.tipoServicio }}</h3>
      <p>Moto: {{ nombreMoto(r.motoId) }}</p>

      <p *ngIf="r.tipoRecordatorio === 'fecha'">
        Recordar el {{ r.fechaObjetivo }}
      </p>
      <p *ngIf="r.tipoRecordatorio === 'km'">
        Recordar a los {{ r.kmObjetivo | number:'1.0-0' }} km
      </p>

      <label class="toggle-line">
        <input
          type="checkbox"
          [checked]="r.activo"
          (change)="onToggleActivo(r, $event.target.checked)"
        />
        Activo
      </label>

      <button type="button" (click)="onEliminar(r)">
        Eliminar
      </button>
    </div>
  </div>

  <ng-template #sinRecordatorios>
    <p class="empty">No tienes recordatorios registrados a√∫n.</p>
  </ng-template>

  <!-- Formulario nuevo recordatorio -->
  <div class="form-card">
    <h3>Crear recordatorio</h3>

    <form (ngSubmit)="onAgregar()">

      <div class="form-group">
        <label for="motoId">Motocicleta</label>
        <select
          id="motoId"
          name="motoId"
          [(ngModel)]="form.motoId"
          required
        >
          <option *ngFor="let m of motos" [ngValue]="m.id">
            {{ m.marca }} {{ m.modelo }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="tipoServicio">Tipo de servicio</label>
        <select
          id="tipoServicio"
          name="tipoServicio"
          [(ngModel)]="form.tipoServicio"
          required
        >
          <option *ngFor="let t of tiposServicios" [ngValue]="t">
            {{ t }}
          </option>
        </select>
      </div>

      <div class="form-group">
        <label for="tipoRecordatorio">Recordar por</label>
        <select
          id="tipoRecordatorio"
          name="tipoRecordatorio"
          [(ngModel)]="form.tipoRecordatorio"
          required
        >
          <option [ngValue]="'fecha'">Fecha</option>
          <option [ngValue]="'km'">Kilometraje</option>
        </select>
      </div>

      <div class="form-group" *ngIf="form.tipoRecordatorio === 'fecha'">
        <label for="fechaObjetivo">Fecha objetivo</label>
        <input
          id="fechaObjetivo"
          type="date"
          name="fechaObjetivo"
          [(ngModel)]="form.fechaObjetivo"
        />
      </div>

      <div class="form-group" *ngIf="form.tipoRecordatorio === 'km'">
        <label for="kmObjetivo">Kilometraje objetivo (km)</label>
        <input
          id="kmObjetivo"
          type="number"
          name="kmObjetivo"
          [(ngModel)]="form.kmObjetivo"
        />
      </div>

      <button type="submit" class="btn-primary">
        Guardar recordatorio
      </button>
    </form>
  </div>

</ion-content>
